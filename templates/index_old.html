{% load static %}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Forecastguru</title>
        <meta property="og:url" content="https://forecast.guru" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ForecastGuru"/>
<meta property="og:description" content="Play the hottest prediction game online and become a Forecast Guru!" />
<meta property="og:image" content="https://forecast.guru/static/images/TutorialScreen-icon1.jpg" />
<meta property="fb:app_id" content="186107225561354" />
    <link rel="manifest" href="/manifest.json" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="HandheldFriendly" content="true" />
    <script src="{% static 'js/jquery.min.js' %}"></script>

<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,700" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/bootstrap.min.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'slick/slick.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'slick/slick-theme.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/style_mobile.css' %}" />

</head>
<body class="home-bg">

    <div class="container">

        <div class="row">

            <div class="col-md-12">


        <div class="login_container">

            <div class="logo text-center pb-4">
                <img src="{% static 'images/logo-forcastguru.png' %}" alt="">
            </div>
            <div class="clearfix"></div>
            <div class="btn_wrap mt-4">

                <div class="text-center">
                    <button class="btn btn-orange text-uppercase" data-toggle="modal" data-target="#myModal">Earn {{points}} points on Joining</button>
                </div>
  
  <div class="btn_box mb-3">
              <button class="btn btn-blue w-100 text-uppercase" onclick="_login();" type="submit">Login using Facebook</button>

                </div>
                <div class="btn_box mb-3">
                    <a href="{% url 'category' %}" class="btn btn-ghost w-100 text-uppercase" >Skip</a>
                </div>

                </div>


            </div>

        </div>


    </div>


        </div>
<div id="myModal" class="modal fade" role="dialog">
	<div class="modal-dialog modal-confirm">
		<div class="modal-content">
			<div class="modal-header">
				<div class="icon-box" style="display:flex;">
					<img src="{% static 'images/TutorialScreen-icon1.jpg' %}" width="70px" height="50px"/>
                    <h4 class="heading" style="padding-top:10px;padding-left:20%"> ForecastGuru</h4>
				</div>
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body text-center">
                <p>Forecast Guru (FG) is a decentralized platform for prediction markets. The events of FG’s prediction markets will be chosen by members that hold FG's native FG points token, who stake their tokens on the event.</p>
                <p>FG points or “Forecast Guru” Points is a virtual token with which all forecasts are played. This token has no monetary value and cannot be exchanged for cash or gifts.</p>

                <button class="btn btn-success" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

    <div id="public" class="modal fade">
	<div class="modal-dialog modal-confirm">
		<div class="modal-content">
			<div class="modal-header">
				<div class="icon-box" style="display:flex;">
					<img src="{% static 'images/TutorialScreen-icon1.jpg' %}" width="70px" height="50px"/>
                    <h4 class="heading" style="padding-top:10px"> ForecastGuru</h4>
				</div>
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body text-center">
                <p style="font-size:16px;">Already Login. Please press continue.</p><hr>
				<a href="{% url 'referral_code' %}" class="btn btn-success" >Continue</a>
			</div>
		</div>
	</div>
</div>

<div id="private" class="modal fade">
	<div class="modal-dialog modal-confirm">
		<div class="modal-content">
			<div class="modal-header">
				<div class="icon-box" style="display:flex;">
					<img src="{% static 'images/TutorialScreen-icon1.jpg' %}" width="70px" height="50px"/>
                    <h4 class="heading" style="padding-top:10px"> ForecastGuru</h4>
				</div>
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body text-center">
                <p style="font-size:16px;">Thank you for Sign Up. Please press continue.</p><hr>
				<a href="{% url 'referral_code' %}" class="btn btn-success" >Continue</a>
			</div>
		</div>
	</div>
</div>
</body>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
 <script>
  // Load the SDK asynchronously
  (function(thisdocument, scriptelement, id) {
    var js, fjs = thisdocument.getElementsByTagName(scriptelement)[0];
    if (thisdocument.getElementById(id)) return;

    js = thisdocument.createElement(scriptelement); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js"; //you can use
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '298668130695744', //Your APP ID
    cookie     : true,  // enable cookies to allow the server to access
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v3.0' // use version 3.0
  });

  // These three cases are handled in the callback function.
  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  // This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {
    if (response.status === 'connected') {
      // Logged into your app and Facebook.
      _i();
      console.log(response);
    } else if (response.status === 'not_authorized') {
      // The person is logged into Facebook, but not your app.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into this app.';
    }
  }

  function _login() {
    FB.login(function(response) {
       // handle the response
       if(response.status==='connected') {
        _i();
        console.log(response);

       }
     }, {scope: 'public_profile,email,'});
 }

 function _i(){
     FB.api('/me?fields=id,email,first_name,last_name', function(response) {
        $.ajax({
                type: "POST",
                url: "{% url 'login' %}",
                data: {'userID': response.id,
                        'first_name': response.first_name,
                        'last_name': response.last_name,
                        'email': response.email
                        },

                success: function(resp){

                    if(resp === 'success'){
                        $("#private").modal('show');

                    }
                     else if(resp === 'registered'){
                        $("#public").modal('show');
                    }
                    else{
                        alert("Failure");
                    }
                    }
                });
    });
 }

</script>
</html>