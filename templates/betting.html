{% load static %}

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Forecastguru</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="true" />
    <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,700" rel="stylesheet">
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/bootstrap.min.css' %}" />
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/style_mobile.css' %}" />
</head>
<body class="gray-bg">
<header class="position-fixed w-100">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 text-center position-relative">
          <div class="header-logo position-absolute"><img src="{% static 'images/logo-small-white.png' %}" alt=""></div>
        <h1>Forecast Detail</h1>
        <!--<div class="header-right with-btn position-absolute"><a href="#" class="btn btn-orange"> Create <br>Forecast</a></div>-->
      </div>
    </div>
  </div>
</header>
<div class="topspace2"></div>
<div class="forcast_detail fixed_p_footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h2>{{forecast.heading}}</h2>
 {% if forecast.approved.name == 'yes' %}
          <hr>
           <div class="form-group form-inline">
        <input type="text" class="form-control" id="awb" value="{{forecast.id}}" style="display:none;" ><br>
        <div class="col-12"><p> Please select vote type</p></div>
        <div class="predictwrap">

                <div style="display:flex;">
                <input type="radio" id="contactChoice1" name="contact" value="email" style="margin-left:10px;">
                   &nbsp; <label for="contactChoice1" style="margin-bottom:5px;">Yes</label>

                <input type="radio" id="contactChoice2" name="contact" value="phone" style="margin-left:10px;">
                   &nbsp; <label for="contactChoice2" style="margin-bottom:5px;">No</label>
                    </div>
          <br>
          <div style="display:none;" id="point_div">

              <label for="points" style="justify-content: left; "><strong>FG Points</strong></label>
            <input type="button" class="btn btn-danger btn-sm" id="sub" value="-" style="width:26px;"/>
            &nbsp;
            <input type="text" value="1000" id="points" name="points" style="height:30px;"/>

            <input type="button" class="btn btn-success btn-sm" id="add" value="+" />
            <input type="text" id="forecast" value="{{forecast.id}}" style="display:None">
            <button class="btn btn-sm btn-orange text-uppercase submit_forecast"> Submit</button>

              </div>


             </div>

{% endif %}
</div>
          <hr class="hr">
            <p>Status :  {% if forecast.approved.name == 'yes' %}<span>{{status}}</span> {% else %}<span>Pending for approval</span>{% endif %} </p>
          <p>Closes <img src="{% static 'images/calender-blue.png' %}" class="ml-2 mr-2"> <span class="value-color">{{end_date}}</span> <img src="{% static 'images/time-blue.png' %}" class="ml-2 mr-2"> <span class="value-color">{{end_time}}</span> </p>
      </div>
    </div>

    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">

        <div class="col-12">
            <div class="row mb-2">
                <div class="col-5">
                    Created By
                </div>
                <div class="col-7 text-right value-color">
                    {{user}}
                </div>
              </div>

              <div class="row mb-2">
                  <div class="col-5">
                      FG Status
                  </div>
                  <div class="col-7 text-right value-color">
                      {% if forecast.approved.name == 'yes' %}<span>{{status}}</span> {% else %}<span>Pending for approval</span>{% endif %}
                      ({{percent}}% success rate. {{sums}} Forecasts)
                  </div>
                </div>
        </div>

      </div>
      <div class="clearfix"></div>
      <div class="row white_box mr-0 ml-0 mb-3">

        <div class="col-12">
            <div class="row mb-2">
                <div class="col-6">
                    FG Points for Yes
                </div>
                <div class="col-6 text-right value-color">
                    {{bet_for}}
                </div>
              </div>

              <div class="row mb-2">
                  <div class="col-6">
                    FG Points for No
                  </div>
                  <div class="col-6 text-right value-color">
                      {{against}}
                  </div>
                </div>
        </div>

      </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="m-0">Result</p>
      </div>
      <div class="col-6 text-right value-color">
          {% if forecast.status.name == 'In-Progress' %}
            <p class="m-0">Awaited</p>
          {% else %}
          <p class="m-0">Declared</p>
          {% endif %}
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="m-0">Result Source</p>
      </div>
      <div class="col-6 text-right value-color">
        <p class="m-0"><a href="#" class="color-darkblue">{{forecast.source.name}}</a></p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-12">
        <div class="row">
          <div class="col-8">
            <p>Total FG wagered</p>
          </div>
          <div class="col-4 text-right value-color">
            <p>NA</p>
          </div>
        </div>
        <div class="row">
          <div class="col-8">
            <p>Market Fee Collected</p>
          </div>
          <div class="col-4 text-right value-color">
            <p>NA</p>
          </div>
        </div>
        <div class="row">
          <div class="col-8">
            <p class="m-0">FG win for every 1 FG</p>
          </div>
          <div class="col-4 text-right value-color">
            <p class="m-0">NA</p>
          </div>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
    <!--<div class="row mb-2">-->
        <!--<div class="col-12"> <button class="btn w-100 btn-orange text-uppercase btn-lg submit"> Participate in the Forecast</button> </div>-->
    <!--</div>-->
  </div>
</div>
<footer class="sticky-footer">
  <nav class="navbar">
    <ul class="navbar-nav nav-fill w-100 text-center">
         <li class="nav-item">
                        <a class="nav-link" href="{% url 'live_forecast' %}">
                            <img src="{% static 'images/menu-icon-forecast.png' %}" alt=""><br>
                            Forecasts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'category' %}">
                            <img src="{% static 'images/menu-icon-category.png' %}" alt=""><br>
                            Categories</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'forecast_result' %}">
                            <img src="{% static 'images/menu-icon-results.png' %}" alt=""><br>
                            Results</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'user_profile' %}">
                            <img src="{% static 'images/menu-icon-settings.png' %}" alt=""><br>
                            Settings</a>
                    </li>
    </ul>
  </nav>
</footer>
<script>
    $("#add").click(function(){
        var awb = $("#points").val();
        var vals = parseInt(awb) + 1000;
        $("#points").val(vals);
    });
    $("#sub").click(function(){
        var awb = $("#points").val();
        var vals = parseInt(awb) - 1000;
        if( vals < 100){
               $("#points").val(1000);
            }else{
               $("#points").val(vals);
            }
    });

$(".submit_forecast").click(function(){
    var radioValue = $("input[name='contact']:checked").val();

    var forecast = $("#forecast").val();
    var point = $("#points").val();
    if(radioValue === "email" || radioValue == "phone"){
        if( parseInt(point) % 1000 === 0){
            $.ajax({
                type: "POST",
                url: "{% url 'bet_save' %}",
                data: {'vote': radioValue, "points":point, 'forecast':forecast},

                success: function(resp){
                    console.log(resp);
                    var data = JSON.parse(resp);
                    if(data.message=="success"){
                    console.log(data.message);
                        alert("Forecast Placed");
                        location.reload();
                        }
                    else if(data.message=="balance"){
                            alert("You ForeCast Guru Balance is low");
                            window.location.href = "{% url 'payment' %}";
                    }
                    else if(data.message=="login"){
                            alert("Please login!!");
                            window.location.href = "{% url 'blank_page' %}";
                    }
                    else{
                        alert(data.message);
                        }
                    }

                });

            }
        else{
            alert("Points should be multiple of 1000");
            }
            }
        else{
            alert("Please select vote type");

            }

    });



$(document).ready(function(){
    $('input[type="radio"]').click(function(){
         $("#point_div").show();
    });
});
</script>
</body>
</html>
