{% load static %}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Forecastguru</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="true" />
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,700" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">
  <script src="{% static 'js/bootstrap.min.js' %}" ></script>
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/bootstrap.min.css' %}" />
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/style_mobile.css' %}" />

</head>
<body class="gray-bg">
<header class="position-fixed w-100">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 text-center">
        <h1>ForecastGuru</h1>
      </div>
    </div>
  </div>
</header>

<div class="topspace2"></div>
{% if user == "" %}
        <p>Please login to see this feature</p>
        <a href="/" class="btn btn-create">Login</a>
        {% else %}

<div class="forcast_detail fixed_p_footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h2>{{forecast.heading}}</h2>
        <hr class="hr">

        <p>Status : <span>{{status}}</span></p>

        <p>Closes <img src="{% static 'images/calender-blue.png' %}" class="ml-2 mr-2"> <span class="value-color">{{end_date}}</span> <img src="{% static 'images/time-blue.png' %}" class="ml-2 mr-2"> <span class="value-color">{{end_time}}</span> </p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="mb-1">Created By</p>
        <p>FG Status</p>
      </div>
      <div class="col-6 text-right value-color">
        <p class="mb-2">{{forecast.user}}</p>
        <p class="mb-1 value-color"> {{forecast.user.fg_status}} ({{percent}}% success rate.</p>
        <p>{{success}} Forecasts)</p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="mb-1">FG Votes FOR</p>
        <p class="mb-2">FG Votes Against</p>
      </div>
      <div class="col-6 text-right value-color">
        <p class="mb-2">{{bet_for}}</p>
        <p>{{against}}</p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="m-0">Forecast Incorrect</p>
      </div>
      <div class="col-6 text-right value-color">
        <p class="m-0 font-weight-bold"><img src="{% static 'images/icon-cross.png' %}" alt=""></p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-6">
        <p class="m-0">Result Source</p>
      </div>
      <div class="col-6 text-right value-color">
        <p class="m-0"><a href="#" class="color-darkblue">{{forecast.source}}</a></p>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="row white_box mr-0 ml-0 mb-3">
      <div class="col-12">
        <div class="row">
          <div class="col-6">
            <p>Total FG wagered</p>
          </div>
          <div class="col-6 text-right value-color">
            <p>NA</p>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <p>Market Fee Collected</p>
          </div>
          <div class="col-6 text-right value-color">
            <p>{{forecast.market_fee}}%</p>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <p class="m-0">FG win for every 1 FG wagered</p>
          </div>
          <div class="col-6 text-right value-color">
            <p class="m-0">NA</p>
          </div>
        </div>
      </div>
    </div>

    <div class="clearfix"></div>
    <div class="row mb-2">
      <div class="col-12">
      {% if user == "" %}
<button style="background: #403c55;color: white;" disabled type="button" class="btn w-100 btn-create" data-toggle="modal" data-target="#exampleModal">
Predict</button>
    {% else %}
          <button style="background: #403c55;color: white;" disabled type="button" class="btn w-100 btn-create" data-toggle="modal" data-target="#exampleModal">
Predict</button> {% endif %}
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Make Forecast for {{forecast.category}} - {{forecast.sub_category.name}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="post">
            <p>Please select your preferred voting type:</p>
          <p style="color:red;"> **Vote count should be multiple of 1000</p>

  <div>
    <input type="radio" id="contactChoice1"
     name="contact" value="email">
    <label for="contactChoice1">Vote For</label>

    <input type="radio" id="contactChoice2"
     name="contact" value="phone">
    <label for="contactChoice2">Vote Against</label>

  </div>
    <label for="points">Points</label>
            <input type="text" value="1000" id="points" name="points"/>

            <input type="button" id="sub" value="-"/>
            <input type="button" id="add" value="+"/>
            <input type="text" id="forecast" value="{{forecast.id}}" style="display:None">
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background: #403c55;color: white;">Close</button>
        <button type="button" class="btn btn-primary submit" style="background: #403c55;color: white;">Save changes</button>
      </div>
    </div>
  </div>
</div>
      </div>
  </div>
</div>
<footer class="sticky-footer">
  <nav class="navbar">
    <ul class="navbar-nav nav-fill w-100 text-center">
         <li class="nav-item">
                        <a class="nav-link" href="{% url 'live_forecast' %}">
                            <img src="{% static 'images/menu-icon-forecast.png' %}" alt=""><br>
                            Forecasts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'category' %}">
                            <img src="{% static 'images/menu-icon-category.png' %}" alt=""><br>
                            Categories</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="{% url 'my_forecast' %}">
                            <img src="{% static 'images/menu-icon-friend.png' %}" alt=""><br>
                            Me & My <br>
                                Friend </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'forecast_result' %}">
                            <img src="{% static 'images/menu-icon-results.png' %}" alt=""><br>
                            Results</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'user_profile' %}">
                            <img src="{% static 'images/menu-icon-settings.png' %}" alt=""><br>
                            Settings</a>
                    </li>
    </ul>
  </nav>
</footer>

<script>
    $("#add").click(function(){
        var awb = $("#points").val();
        var vals = parseInt(awb) + 1000;
        $("#points").val(vals);
    });
    $("#sub").click(function(){
        var awb = $("#points").val();
        var vals = parseInt(awb) - 1000;
        if( vals < 100){
               $("#points").val(1000);
            }else{
               $("#points").val(vals);
            }
    });

$(".submit").click(function(){
    var radioValue = $("input[name='contact']:checked").val();
    var forecast = $("#forecast").val();
    var point = $("#points").val();
    $.ajax({
        type: "POST",
        url: "{% url 'bet_save' %}",
        data: {'vote': radioValue, "points":point, 'forecast':forecast},

        success: function(resp){
            console.log(resp);
            $("#exampleModal").modal('hide');
            var data = JSON.parse(resp);
            alert(data.message);
            location.reload();
            }

    });

    });
</script>
    {% endif %}
</body>
</html>